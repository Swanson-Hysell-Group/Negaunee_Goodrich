setwd("~/Github/Negaunee_Goodrich/data/geochron")
library(dplyr)
library(IsoplotR)
library(scales)
library(stringr)
library(ggplot2)
library(common)
##### Function for splitting up samples in output table from Iolite and getting into isoplotr format####
## The function takes in the dataframe of the u/pb data and an option for whether to use the internal or excess uncertainty (prop)
splt_data<-function(df,sample,prop){
if(prop==TRUE){
samp<-df%>%
filter(str_detect(X,regex(sample)))%>%
select(c("X238U.206Pb","X238U.206Pb.2SE.prop.","X207Pb.206Pb",
"X207Pb.206Pb.2SE.prop.","Err.Corr.7.6.v.8.6")) %>%
distinct()%>%
na.omit(samp)
read.data(samp,method='U-Pb',format=2,ierr=2)
}
else{
samp<-df%>%
filter(str_detect(X,regex(sample)))%>%
select(c("X238U.206Pb","X238U.206Pb.2SE.int.",
"X207Pb.206Pb","X207Pb.206Pb.2SE.int.","Err.Corr.7.6.v.8.6")) %>%
distinct()%>%
na.omit(samp)
read.data(samp,method='U-Pb',format=2,ierr=2)
}
}
########### Read in upb file #############
upb_data<-read.csv("U_Pb_data.csv")
jk23<-splt_data(upb_data,"JK23",TRUE)
jk25<-splt_data(upb_data,"JK_25_G",TRUE)
jk21<-splt_data(upb_data,"JK_21_G_Band",TRUE)
vein<-splt_data(upb_data,"JK_21_G_Vein",TRUE)
Fe_grab<-splt_data(upb_data,"Fe-Grab",TRUE)
####JK 21####
# Jaspilite facies specimen with two textures- a vein and the bands
concordia(jk21,type=2,tlim=(5300:1100),ellipse.fill = alpha('#de2d26',0.6),ticks = 10,show.numbers = FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,hide=c(1,39,51,42,36,43),cex.lab=(2),cex.axis=(1.5))
concordia(vein,type=2,ellipse.fill = alpha("#2c7fb8",0.6),ticks = 10,show.numbers=FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,hide=c(41,38,37),cex.lab=(2),cex.axis=(1.5))
####JK23 plotting####
# This sample is one of the enriched facies samples
pts<-c(23,33,57,49,59,3,43,60,6,47,41,16,62,58,42,67,11,17,31,46,39,
54,45,66,19)
concordia(jk23,type=2,tlim=(5300:540),ellipse.fill = alpha('#de2d26',0.6),ticks = 10,show.numbers = FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,hide=pts,cex.lab=(2),cex.axis=(1.5))
####JK 25####
# another enriched sample
concordia(jk25,type=2,tlim=(5300:550),ellipse.fill = alpha('#de2d26',0.6),ticks = 10,show.numbers =FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,hide=c(20,1,41),cex.lab=(2),cex.axis=(1.5))
#### Goodrich Conglomerate####
GQ6<-splt_data(upb_data,"GQ6_2_matrix",TRUE)
concordia(GQ6,type=2,tlim=(5300:1500),ellipse.fill = alpha('#de2d26',0.6),ticks = 10,show.numbers = FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,cex.lab=(2),cex.axis=(1.5))
#### Fe Grab####
fe_pts<-c(1,13,38,22,15,40,31,25,28,44,34,4,33,35,
45,36,39,30,10,8,41,37,17,42)
concordia(Fe_grab,type=2,ellipse.fill = alpha('#de2d26',0.6),ticks = 10,show.numbers =FALSE,
concordia.col = 'black',show.age = 2,oerr=2,common.Pb = 0,hide=fe_pts,cex.lab=(2),cex.axis=(1.5))
